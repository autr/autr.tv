import{S as e,i as t,s as n,e as s,c as a,b as l,d as r,f as o,j as i,l as c,m as d,w as f,x as h,B as u,q as $,r as p,C as m,p as g,L as x,A as w,Y as y,u as v,T as b,M as k,Q as E,v as I,a as D,g as A,k as V,n as j,R as P,I as T,F as B,t as H,h as N,o as C}from"../../chunks/vendor-23824d3e.js";import{a as M,p as S}from"../../chunks/stores-0bc72f03.js";import{P as R,u as q}from"../../chunks/PostText-e2c156bf.js";import{c as F,s as L,M as O}from"../../chunks/store-f19ea592.js";function Q(e){let t,n,x;const w=[{index:e[1]},{hidden:e[4]},{focus:e[5]},e[6](e[2])];var y=e[0];function b(e){let t={};for(let n=0;n<w.length;n+=1)t=v(t,w[n]);return{props:t}}return y&&(n=new y(b())),{c(){t=s("section"),n&&a(n.$$.fragment)},l(e){t=l(e,"SECTION",{});var s=r(t);n&&o(n.$$.fragment,s),s.forEach(i)},m(s,a){c(s,t,a),n&&d(n,t,null),e[9](t),x=!0},p(e,[s]){const l=118&s?f(w,[2&s&&{index:e[1]},16&s&&{hidden:e[4]},32&s&&{focus:e[5]},68&s&&h(e[6](e[2]))]):{};if(y!==(y=e[0])){if(n){u();const e=n;$(e.$$.fragment,1,0,(()=>{p(e,1)})),m()}y?(n=new y(b()),a(n.$$.fragment),g(n.$$.fragment,1),d(n,t,null)):n=null}else y&&n.$set(l)},i(e){x||(n&&g(n.$$.fragment,e),x=!0)},o(e){n&&$(n.$$.fragment,e),x=!1},d(s){s&&i(t),n&&p(n),e[9](null)}}}function U(e,t,n){let s,a;x(e,F,(e=>n(8,a=e))),x(e,L,(e=>n(12,e)));let l,r,o,{component:i}=t,{index:c}=t,{data:d}=t,{keys:f}=t;function h(e){if(!c)return;const t=(null==l?void 0:l.getBoundingClientRect())||{};{null==o&&(o=0),n(4,u=-1*t.y>t.height-o||t.y>window.innerHeight-o);const e=a.center||999999999,s=a.index,l=Math.abs(t.y+t.height/2-window.innerHeight/2);c==s&&l!=e&&b(F,a={center:l,index:c},a),l<e&&s!=c&&(console.log("[PostItem] ✨☯️✨  switching to new centroid:",c),b(F,a={center:l,index:c},a))}}w((async e=>{r=L.subscribe(h),h()})),y((async e=>{r&&await r()}));let u=!0;return e.$$set=e=>{"component"in e&&n(0,i=e.component),"index"in e&&n(1,c=e.index),"data"in e&&n(2,d=e.data),"keys"in e&&n(7,f=e.keys)},e.$$.update=()=>{258&e.$$.dirty&&n(5,s=(null==a?void 0:a.index)==c&&null!=c)},[i,c,d,l,u,s,function(e){let t={};return f.forEach((n=>t[n]=e[n])),t},f,a,function(e){k[e?"unshift":"push"]((()=>{l=e,n(3,l)}))}]}class Y extends e{constructor(e){super(),t(this,e,U,Q,n,{component:0,index:1,data:2,keys:7})}}function z(e,t,n){const s=e.slice();return s[15]=t[n],s[17]=n,s}function G(e){let t,n,s=!e[6]&&function(e){let t,n;return t=new Y({props:{index:e[17],component:e[0],keys:e[1],data:e[15]}}),{c(){a(t.$$.fragment)},l(e){o(t.$$.fragment,e)},m(e,s){d(t,e,s),n=!0},p(e,n){const s={};1&n&&(s.component=e[0]),2&n&&(s.keys=e[1]),36&n&&(s.data=e[15]),t.$set(s)},i(e){n||(g(t.$$.fragment,e),n=!0)},o(e){$(t.$$.fragment,e),n=!1},d(e){p(t,e)}}}(e);return{c(){s&&s.c(),t=I()},l(e){s&&s.l(e),t=I()},m(e,a){s&&s.m(e,a),c(e,t,a),n=!0},p(e,t){e[6]||s.p(e,t)},i(e){n||(g(s),n=!0)},o(e){$(s),n=!1},d(e){s&&s.d(e),e&&i(t)}}}function J(e){let t,n,a,o;const d=e[9].default,f=E(d,e,e[8],null);let h=e[2].slice(0,e[5]),p=[];for(let s=0;s<h.length;s+=1)p[s]=G(z(e,h,s));const x=e=>$(p[e],1,1,(()=>{p[e]=null}));return{c(){t=s("div"),f&&f.c(),n=D();for(let e=0;e<p.length;e+=1)p[e].c();this.h()},l(e){t=l(e,"DIV",{class:!0,style:!0});var s=r(t);f&&f.l(s),n=A(s);for(let t=0;t<p.length;t+=1)p[t].l(s);s.forEach(i),this.h()},h(){V(t,"class",a="flex column grow "+e[3]),V(t,"style",e[4])},m(e,s){c(e,t,s),f&&f.m(t,null),j(t,n);for(let n=0;n<p.length;n+=1)p[n].m(t,null);o=!0},p(e,[n]){if(f&&f.p&&(!o||256&n)&&P(f,d,e,e[8],n,null,null),103&n){let s;for(h=e[2].slice(0,e[5]),s=0;s<h.length;s+=1){const a=z(e,h,s);p[s]?(p[s].p(a,n),g(p[s],1)):(p[s]=G(a),p[s].c(),g(p[s],1),p[s].m(t,null))}for(u(),s=h.length;s<p.length;s+=1)x(s);m()}(!o||8&n&&a!==(a="flex column grow "+e[3]))&&V(t,"class",a),(!o||16&n)&&V(t,"style",e[4])},i(e){if(!o){g(f,e);for(let e=0;e<h.length;e+=1)g(p[e]);o=!0}},o(e){$(f,e),p=p.filter(Boolean);for(let t=0;t<p.length;t+=1)$(p[t]);o=!1},d(e){e&&i(t),f&&f.d(e),T(p,e)}}}function K(e,t,n){let s;x(e,L,(e=>n(12,s=e)));let a,{$$slots:l={},$$scope:r}=t,{component:o}=t,{keys:i}=t,{data:c}=t,{max:d=10}=t,{class:f=""}=t,{style:h=""}=t,u=new Date;function $(e){if(e.itemsTop>e.itemsHeight-1.5*window.innerHeight){const e=new Date;e-u>500&&(n(5,p+=d),u=e)}}w((async e=>{$(s),a=L.subscribe($)})),y((async e=>a));let p=d;return e.$$set=e=>{"component"in e&&n(0,o=e.component),"keys"in e&&n(1,i=e.keys),"data"in e&&n(2,c=e.data),"max"in e&&n(7,d=e.max),"class"in e&&n(3,f=e.class),"style"in e&&n(4,h=e.style),"$$scope"in e&&n(8,r=e.$$scope)},e.$$.update=()=>{e.$$.dirty},[o,i,c,f,h,p,undefined,d,r,l]}class W extends e{constructor(e){super(),t(this,e,K,J,n,{component:0,keys:1,data:2,max:7,class:3,style:4})}}function X(e,t,n){const s=e.slice();return s[13]=t[n],s[15]=n,s}function Z(e){let t,n,f,h,u;return f=new O({props:{file:e[13],root:"/posts/",paused:!e[8],active:!e[7]}}),{c(){t=s("div"),n=s("a"),a(f.$$.fragment),this.h()},l(e){t=l(e,"DIV",{class:!0});var s=r(t);n=l(s,"A",{class:!0,href:!0,id:!0});var a=r(n);o(f.$$.fragment,a),a.forEach(i),s.forEach(i),this.h()},h(){V(n,"class","flex grow w100pc"),V(n,"href",e[9]),V(n,"id",h=e[0]+"-media"),V(t,"class","flex grow"),B(t,"maxw70pc",e[11].length<=2),B(t,"maxw50pc",e[11].length>2)},m(e,s){c(e,t,s),j(t,n),d(f,n,null),u=!0},p(e,s){const a={};2048&s&&(a.file=e[13]),256&s&&(a.paused=!e[8]),128&s&&(a.active=!e[7]),f.$set(a),(!u||512&s)&&V(n,"href",e[9]),(!u||1&s&&h!==(h=e[0]+"-media"))&&V(n,"id",h),2048&s&&B(t,"maxw70pc",e[11].length<=2),2048&s&&B(t,"maxw50pc",e[11].length>2)},i(e){u||(g(f.$$.fragment,e),u=!0)},o(e){$(f.$$.fragment,e),u=!1},d(e){e&&i(t),p(f)}}}function _(e){let t,n,f,h,x,w,y,v=e[11].length+"",b=e[11],k=[];for(let s=0;s<b.length;s+=1)k[s]=Z(X(e,b,s));const E=e=>$(k[e],1,1,(()=>{k[e]=null}));return w=new R({props:{id:e[0],title:e[1],text:e[2],created:e[3],updated:e[4],original:e[5],index:e[6]}}),{c(){t=s("div");for(let e=0;e<k.length;e+=1)k[e].c();n=D(),f=s("div"),h=H(v),x=D(),a(w.$$.fragment),this.h()},l(e){t=l(e,"DIV",{id:!0,title:!0,class:!0});var s=r(t);for(let t=0;t<k.length;t+=1)k[t].l(s);n=A(s),f=l(s,"DIV",{class:!0});var a=r(f);h=N(a,v),x=A(a),o(w.$$.fragment,a),a.forEach(i),s.forEach(i),this.h()},h(){V(f,"class","flex w30pc column"),V(t,"id",e[0]),V(t,"title",e[1]),V(t,"class","flex grow wrap mb10"),B(t,"row",!e[10]),B(t,"row-reverse",e[10])},m(e,s){c(e,t,s);for(let n=0;n<k.length;n+=1)k[n].m(t,null);j(t,n),j(t,f),j(f,h),j(f,x),d(w,f,null),y=!0},p(e,[s]){if(2945&s){let a;for(b=e[11],a=0;a<b.length;a+=1){const l=X(e,b,a);k[a]?(k[a].p(l,s),g(k[a],1)):(k[a]=Z(l),k[a].c(),g(k[a],1),k[a].m(t,n))}for(u(),a=b.length;a<k.length;a+=1)E(a);m()}(!y||2048&s)&&v!==(v=e[11].length+"")&&C(h,v);const a={};1&s&&(a.id=e[0]),2&s&&(a.title=e[1]),4&s&&(a.text=e[2]),8&s&&(a.created=e[3]),16&s&&(a.updated=e[4]),32&s&&(a.original=e[5]),64&s&&(a.index=e[6]),w.$set(a),(!y||1&s)&&V(t,"id",e[0]),(!y||2&s)&&V(t,"title",e[1]),1024&s&&B(t,"row",!e[10]),1024&s&&B(t,"row-reverse",e[10])},i(e){if(!y){for(let e=0;e<b.length;e+=1)g(k[e]);g(w.$$.fragment,e),y=!0}},o(e){k=k.filter(Boolean);for(let t=0;t<k.length;t+=1)$(k[t]);$(w.$$.fragment,e),y=!1},d(e){e&&i(t),T(k,e),p(w)}}}function ee(e,t,n){let s,a,l,{id:r}=t,{title:o}=t,{text:i}=t,{files:c}=t,{created:d}=t,{updated:f}=t,{original:h=""}=t,{index:u}=t,{hidden:$}=t,{focus:p}=t;return e.$$set=e=>{"id"in e&&n(0,r=e.id),"title"in e&&n(1,o=e.title),"text"in e&&n(2,i=e.text),"files"in e&&n(12,c=e.files),"created"in e&&n(3,d=e.created),"updated"in e&&n(4,f=e.updated),"original"in e&&n(5,h=e.original),"index"in e&&n(6,u=e.index),"hidden"in e&&n(7,$=e.hidden),"focus"in e&&n(8,p=e.focus)},e.$$.update=()=>{9&e.$$.dirty&&n(9,s=`/feed/${q.year(d)}/${r}`),4096&e.$$.dirty&&n(11,l=c||[])},n(10,a=!0),[r,o,i,d,f,h,u,$,p,s,true,l,c]}class te extends e{constructor(e){super(),t(this,e,ee,_,n,{id:0,title:1,text:2,files:12,created:3,updated:4,original:5,index:6,hidden:7,focus:8})}}function ne(e,t,n){const s=e.slice();return s[7]=t[n],s}function se(e){let t,n,a,o,d,f,h,u,$,p=e[7]+"";return{c(){t=s("a"),n=s("input"),o=D(),d=s("span"),f=D(),h=H(p),u=D(),this.h()},l(e){t=l(e,"A",{class:!0,href:!0});var s=r(t);n=l(s,"INPUT",{type:!0,checked:!0}),o=A(s),d=l(s,"SPAN",{}),r(d).forEach(i),f=A(s),h=N(s,p),u=A(s),s.forEach(i),this.h()},h(){V(n,"type","checkbox"),n.checked=a=e[0].path==e[3](e[7]),V(t,"class","unclickable checkbox mtb0-5"),V(t,"href",$=e[3](e[7]))},m(e,s){c(e,t,s),j(t,n),j(t,o),j(t,d),j(t,f),j(t,h),j(t,u)},p(e,s){3&s&&a!==(a=e[0].path==e[3](e[7]))&&(n.checked=a),2&s&&p!==(p=e[7]+"")&&C(h,p),2&s&&$!==($=e[3](e[7]))&&V(t,"href",$)},d(e){e&&i(t)}}}function ae(e){let t,n,f,h,u,m,x,w,y,v=e[1].years,b=[];for(let s=0;s<v.length;s+=1)b[s]=se(ne(e,v,s));const k=e[6].default,I=E(k,e,e[5],null);return w=new W({props:{data:e[1].data,keys:e[2],component:te}}),{c(){t=s("nav"),n=s("div");for(let e=0;e<b.length;e+=1)b[e].c();f=D(),h=s("a"),u=H("random"),m=D(),I&&I.c(),x=D(),a(w.$$.fragment),this.h()},l(e){t=l(e,"NAV",{class:!0});var s=r(t);n=l(s,"DIV",{class:!0});var a=r(n);for(let t=0;t<b.length;t+=1)b[t].l(a);a.forEach(i),f=A(s),h=l(s,"A",{class:!0,href:!0});var c=r(h);u=N(c,"random"),c.forEach(i),s.forEach(i),m=A(e),I&&I.l(e),x=A(e),o(w.$$.fragment,e),this.h()},h(){V(n,"class","flex row wrap"),V(h,"class","bb1-solid button text-center ptb0-2 plr2 mtb0-5"),V(h,"href",""),V(t,"class","\n\tflex \n\tptb0-5\n\trow-space-between-center \n\tbt1-solid \n\tbb1-solid \n\twrap\n\t")},m(e,s){c(e,t,s),j(t,n);for(let t=0;t<b.length;t+=1)b[t].m(n,null);j(t,f),j(t,h),j(h,u),c(e,m,s),I&&I.m(e,s),c(e,x,s),d(w,e,s),y=!0},p(e,[t]){if(11&t){let s;for(v=e[1].years,s=0;s<v.length;s+=1){const a=ne(e,v,s);b[s]?b[s].p(a,t):(b[s]=se(a),b[s].c(),b[s].m(n,null))}for(;s<b.length;s+=1)b[s].d(1);b.length=v.length}I&&I.p&&(!y||32&t)&&P(I,k,e,e[5],t,null,null);const s={};2&t&&(s.data=e[1].data),w.$set(s)},i(e){y||(g(I,e),g(w.$$.fragment,e),y=!0)},o(e){$(I,e),$(w.$$.fragment,e),y=!1},d(e){e&&i(t),T(b,e),e&&i(m),I&&I.d(e),e&&i(x),p(w,e)}}}const le=M.get((e=>"http://localhost:3000/api/autr/items/posts?depth=2"));function re(e,t,n){let s,a;x(e,S,(e=>n(0,a=e)));let{$$slots:l={},$$scope:r}=t,{data:o}=t;w((async e=>{})),y((async e=>{}));return e.$$set=e=>{"data"in e&&n(4,o=e.data),"$$scope"in e&&n(5,r=e.$$scope)},e.$$.update=()=>{17&e.$$.dirty&&n(1,s=q.posts(o,a.params.year))},[a,s,["id","created","updated","files","text","title","original"],e=>`/feed/${e}`,o,r,l]}export default class extends e{constructor(e){super(),t(this,e,re,ae,n,{data:4})}}export{le as load};
